import{_ as i,c as a,f as n,o as l}from"./app-C49nKLGn.js";const e={};function h(t,s){return l(),a("div",null,s[0]||(s[0]=[n(`<p>最近遇到一台内网服务器需要同时访问内外网需求，使用双网线策略，由于情况比较特殊，所以记录下踩坑记录</p><hr><h3 id="_1-插上网线后查看本地网卡配置" tabindex="-1"><a class="header-anchor" href="#_1-插上网线后查看本地网卡配置"><span>1. 插上网线后查看本地网卡配置</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ifconfig</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#可能会有很多虚拟网卡，这里可以通过ip找到我们需要配置网卡名</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#外网网卡</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">eno1:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> flags=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4163</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">UP,BROADCAST,RUNNING,MULTICAS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  mtu</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1500</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        inet</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.100.20</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  netmask</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 255.255.255.254</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  broadcast</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.100.21</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        inet6</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> fe80::b21:d2a5:7bca:4e5a</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  prefixlen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  scopeid</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0x20</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">lin</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">k</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        ether</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 18:56:44:35:b9:d6</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  txqueuelen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  (Ethernet)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        RX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packets</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2292</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  bytes</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 284061</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (277.4 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">KiB</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        RX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> errors</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  dropped</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  overruns</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  frame</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        TX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packets</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1506</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  bytes</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 270765</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (264.4 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">KiB</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        TX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> errors</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  dropped</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> overruns</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  carrier</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  collisions</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#内网网卡</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">eno2:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> flags=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4163</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">UP,BROADCAST,RUNNING,MULTICAS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  mtu</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1500</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        inet</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.131</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  netmask</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 255.255.255.128</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  broadcast</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.255</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        inet6</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> fe80::1b42:eb4d:2ac2:558a</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  prefixlen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  scopeid</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0x20</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">lin</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">k</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        ether</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 18:56:44:35:b9:d7</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  txqueuelen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  (Ethernet)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        RX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packets</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1392</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  bytes</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 102845</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (100.4 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">KiB</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        RX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> errors</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  dropped</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 383</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  overruns</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  frame</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        TX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packets</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 111</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  bytes</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 11412</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (11.1 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">KiB</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        TX</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> errors</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  dropped</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> overruns</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  carrier</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  collisions</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#前面的eno1就是网卡的名称</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-去掉内网网关" tabindex="-1"><a class="header-anchor" href="#_2-去掉内网网关"><span>2. 去掉内网网关</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/sysconfig/network-scripts/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ifcfg-eno2</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#主要 关掉内网默认网关，注释原有网关地址</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#默认路由</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">DEFROUTE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">no</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#网关</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#GATEWAY=10.234.93.131</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#开机自动启用</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ONBOOT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">yes</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#网卡优先级，值越小优先级越高</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">IPV4_ROUTE_METRIC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-添加路由" tabindex="-1"><a class="header-anchor" href="#_3-添加路由"><span>3. 添加路由</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#临时添加</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10.234.93.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#永久重启任然生效</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/sysconfig/network-scripts/route-eno2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">10.234.93.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>正常情况上面配置就已经可以正常使用了，下面介绍我遇到特殊情况</p><h3 id="_4-特殊处理" tabindex="-1"><a class="header-anchor" href="#_4-特殊处理"><span>4. 特殊处理</span></a></h3><h3 id="_4-1-公司内网划分多个lan或vlan" tabindex="-1"><a class="header-anchor" href="#_4-1-公司内网划分多个lan或vlan"><span>4.1 公司内网划分多个lan或vlan</span></a></h3><p>这种情况如果不进行手动干预的话，配置完后你将只能访问离你最近路由器内网段，</p><p>例如上面配置10.234.93.0/24 网段，你将无法访问到10.234.95.0/24这些网段。</p><p>因为现在默认网关为外网路由器网关，上面配置内网路由又不可达该其他网段。</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>解决办法也很简单为其他内网网段也设置一条路由，并设置下一跳（这里出口还是内网网关）</p></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#临时添加</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10.234.93.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#其他lan 有多少加多少</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10.234.92.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10.234.99.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.3.0/24</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#这里可以使用一点偷懒写法，虽然公司lan不可能把第一类私有地址全占用了，但是下一跳地址时一样的，</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#这里扩大原有主机位地址，原来只有8位主机位+24位网络位，改为10.0.0.0/8 24位主机位，</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#这样所有10.*.*.*开头地址都会走这条路由</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> route</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10.0.0.0/8</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> via</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10.234.93.129</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eno2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-公司有自己dns服务器-域名解析服务器" tabindex="-1"><a class="header-anchor" href="#_4-2-公司有自己dns服务器-域名解析服务器"><span>4.2 公司有自己DNS服务器(域名解析服务器)</span></a></h3><p>上面配置完后虽然能访问原本内网所能正常到达ip，访问仅存在内网域名时，在经过外网路由默认DNS解析时，将会返回主机不存在错误，</p><p>所以原有DNS解析配置文件也需要修改。</p><h4 id="_1-禁止networkmanager管理本地dns-防止重启失效" tabindex="-1"><a class="header-anchor" href="#_1-禁止networkmanager管理本地dns-防止重启失效"><span>1. 禁止NetworkManager管理本地DNS(防止重启失效)</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/NetworkManager/NetworkManager.conf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#在main部分添加 dns=none</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-修改本地dns服务器地址" tabindex="-1"><a class="header-anchor" href="#_2-修改本地dns服务器地址"><span>2. 修改本地DNS服务器地址</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#可添加多条，按优先级</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nameserver</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 局域网DNS服务器地址</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#下面添加公网DNS服务器地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nameserver</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 114.114.114.114</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>总结就是 内网走自定义路由，其他(外网)走默认路由 让内网路由优先级高一点</p></div>`,25)]))}const p=i(e,[["render",h],["__file","index.html.vue"]]),d=JSON.parse('{"path":"/article/vvrur2xp/","title":"Centos7 双网口内外网同时上网配置策略","lang":"zh-CN","frontmatter":{"title":"Centos7 双网口内外网同时上网配置策略","createTime":"2022/07/06 13:42:35","permalink":"/article/vvrur2xp/","tags":["计网"],"description":"最近遇到一台内网服务器需要同时访问内外网需求，使用双网线策略，由于情况比较特殊，所以记录下踩坑记录 1. 插上网线后查看本地网卡配置 2. 去掉内网网关 3. 添加路由 正常情况上面配置就已经可以正常使用了，下面介绍我遇到特殊情况 4. 特殊处理 4.1 公司内网划分多个lan或vlan 这种情况如果不进行手动干预的话，配置完后你将只能访问离你最近路由...","head":[["meta",{"property":"og:url","content":"https://wantofun.cn/article/vvrur2xp/"}],["meta",{"property":"og:site_name","content":"Want to Fun"}],["meta",{"property":"og:title","content":"Centos7 双网口内外网同时上网配置策略"}],["meta",{"property":"og:description","content":"最近遇到一台内网服务器需要同时访问内外网需求，使用双网线策略，由于情况比较特殊，所以记录下踩坑记录 1. 插上网线后查看本地网卡配置 2. 去掉内网网关 3. 添加路由 正常情况上面配置就已经可以正常使用了，下面介绍我遇到特殊情况 4. 特殊处理 4.1 公司内网划分多个lan或vlan 这种情况如果不进行手动干预的话，配置完后你将只能访问离你最近路由..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-14T01:43:59.000Z"}],["meta",{"property":"article:tag","content":"计网"}],["meta",{"property":"article:modified_time","content":"2024-11-14T01:43:59.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Centos7 双网口内外网同时上网配置策略\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-11-14T01:43:59.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":3,"title":"1. 插上网线后查看本地网卡配置","slug":"_1-插上网线后查看本地网卡配置","link":"#_1-插上网线后查看本地网卡配置","children":[]},{"level":3,"title":"2. 去掉内网网关","slug":"_2-去掉内网网关","link":"#_2-去掉内网网关","children":[]},{"level":3,"title":"3. 添加路由","slug":"_3-添加路由","link":"#_3-添加路由","children":[]},{"level":3,"title":"4. 特殊处理","slug":"_4-特殊处理","link":"#_4-特殊处理","children":[]},{"level":3,"title":"4.1 公司内网划分多个lan或vlan","slug":"_4-1-公司内网划分多个lan或vlan","link":"#_4-1-公司内网划分多个lan或vlan","children":[]},{"level":3,"title":"4.2 公司有自己DNS服务器(域名解析服务器)","slug":"_4-2-公司有自己dns服务器-域名解析服务器","link":"#_4-2-公司有自己dns服务器-域名解析服务器","children":[]}],"readingTime":{"minutes":2.97,"words":891},"git":{"createdTime":1731548639000,"updatedTime":1731548639000,"contributors":[{"name":"fan","email":"yswfgo@qq.com","commits":1}]},"autoDesc":true,"filePathRelative":"运维/Centos7 双网口内外网同时上网配置策略.md","categoryList":[{"id":"60eec8","sort":10003,"name":"运维"}],"bulletin":false}');export{p as comp,d as data};
